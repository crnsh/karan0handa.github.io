---
import PageLayout from "@/layouts/Base";
import PostPreview from "@/components/blog/PostPreview";
import SocialList from "@/components/SocialList";
import { getAllPosts, sortMDByDate } from "@/utils";

const MAX_POSTS = 10;
const allPosts = await getAllPosts();
const allPostsByDate = sortMDByDate(allPosts).slice(0, MAX_POSTS);

const openSourceContributions: Array<{ title: string; desc: string; href: string }> = [
	{
		title: "Unit IO",
		desc: "Next Generation Visual Programming System.",
		href: "https://github.com/samuelmtimbo/unit/",
	},
	{
		title: "Lightdash (YC20)",
		desc: "Open Source Looker Alternative.",
		href: "https://github.com/lightdash/lightdash/pulls?q=is%3Apr+author%3Akaran0handa",
	},
	{
		title: "Tinygrad (George Hotz)",
		desc: "Simple and Powerful Neural Network Framework.",
		href: "https://github.com/tinygrad/tinygrad/pulls?q=is%3Apr+author%3Akaran0handa",
	},
];
---

<PageLayout meta={{ title: "Home" }}>
	<section
		class="relative z-0 overflow-hidden rounded-xl border-2 border-secondary px-10 py-6 shadow-xl"
	>
		<h1 class="title mb-6">Hi, I'm Karan! üôè</h1>
		<p class="mb-4 text-base">
			"Obsessively growing" is the closest phrase that comes to describing what I'm doing and will
			hopefully be doing for the rest of my life. Currently I'm building and learning with really
			cool people and you might just find me as a contributor in your favorite open source
			repository.
		</p>
		<SocialList />
		<script src="../utils/animation.ts"></script>
		<canvas class="zdog-canvas absolute -bottom-20 -right-20 z-20" width="200" height="220"
		></canvas>
	</section>
	<section aria-label="Blog post list" class="mt-16">
		<h2 class="title mb-4 text-xl">Posts</h2>
		<ul class="space-y-4 sm:space-y-2">
			{
				allPostsByDate.map((p) => (
					<li class="flex flex-col gap-x-2 sm:flex-row">
						<PostPreview post={p} />
					</li>
				))
			}
		</ul>
	</section>
	<section class="mt-16">
		<h2 class="title mb-4 text-xl">Open Source Contributions</h2>
		<ul class="space-y-4 sm:space-y-2">
			{
				openSourceContributions.map(({ href, title, desc }) => (
					<li>
						<a
							href={href}
							target="_blank"
							rel="noopener noreferrer"
							class="cactus-link inline-block"
						>
							{title}
						</a>
						:<p class="ml-2 inline-block text-base sm:mt-2">{`${desc}`}</p>
					</li>
				))
			}
		</ul>
	</section>
</PageLayout>
